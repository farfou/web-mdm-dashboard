{"version":3,"sources":["../static/js/5.e929bc99.chunk.js","components/ValidateAccount/index.js"],"names":["webpackJsonp","165","module","__webpack_exports__","__webpack_require__","_asyncToGenerator","fn","gen","apply","this","arguments","Promise","resolve","reject","step","key","arg","info","value","error","done","then","err","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default","n","__WEBPACK_IMPORTED_MODULE_1_react__","__WEBPACK_IMPORTED_MODULE_1_react___default","__WEBPACK_IMPORTED_MODULE_2_prop_types__","__WEBPACK_IMPORTED_MODULE_2_prop_types___default","__WEBPACK_IMPORTED_MODULE_3_react_router_dom__","__WEBPACK_IMPORTED_MODULE_4_shared_publicURL__","__WEBPACK_IMPORTED_MODULE_5_shared_itemtype__","__WEBPACK_IMPORTED_MODULE_6_shared_i18n__","__WEBPACK_IMPORTED_MODULE_7_hoc_withAuthenticationLayout__","__WEBPACK_IMPORTED_MODULE_8_hoc_withHandleMessages__","__WEBPACK_IMPORTED_MODULE_9_hoc_withGLPI__","__WEBPACK_IMPORTED_MODULE_10__Loading__","_createClass","defineProperties","target","props","i","length","descriptor","protoProps","staticProps","ValidateAccount","_PureComponent","_this2","_this","getPrototypeOf","requestValidation","_ref","a","mark","_callee","account","validation","session","response","isValidated","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","item","wrap","_context","prev","next","glpi","initSessionByUserToken","userToken","window","appConfig","demoToken","sent","sessionToken","session_token","updateItem","itemtype","PluginFlyvemdmdemoAccountvalidation","id","input","_validate","Array","isArray","undefined","Symbol","iterator","abrupt","t0","return","finish","setState","isLoading","t1","toast","setNotification","handleMessage","type","message","stop","_x","_x2","state","path","location","pathname","replace","params","URLSearchParams","get","createElement","style","height","t","Fragment","to","propTypes","shape","func","isRequired","object","centerContent"],"mappings":"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","file":"static/js/5.e929bc99.chunk.js","sourcesContent":["webpackJsonp([5],{\n\n/***/ 165:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__ = __webpack_require__(29);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_prop_types__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_prop_types___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_prop_types__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_react_router_dom__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_shared_publicURL__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_shared_itemtype__ = __webpack_require__(59);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_shared_i18n__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_hoc_withAuthenticationLayout__ = __webpack_require__(67);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_hoc_withHandleMessages__ = __webpack_require__(64);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_hoc_withGLPI__ = __webpack_require__(60);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__Loading__ = __webpack_require__(30);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value;}catch(error){reject(error);return;}if(info.done){resolve(value);}else{return Promise.resolve(value).then(function(value){step(\"next\",value);},function(err){step(\"throw\",err);});}}return step(\"next\");});};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}/*\n *   Copyright © 2018 Teclib. All rights reserved.\n *\n *   This file is part of web-mdm-dashboard\n *\n * web-mdm-dashboard is a subproject of Flyve MDM. Flyve MDM is a mobile\n * device management software.\n *\n * Flyve MDM is free software: you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 3\n * of the License, or (at your option) any later version.\n *\n * Flyve MDM is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n * ------------------------------------------------------------------------------\n * @author     Gianfranco Manganiello (gmanganiello@teclib.com)\n * @author     Hector Rondon (hrondon@teclib.com)\n * @copyright  Copyright © 2018 Teclib. All rights reserved.\n * @license    GPLv3 https://www.gnu.org/licenses/gpl-3.0.html\n * @link       https://github.com/flyve-mdm/web-mdm-dashboard\n * @link       http://flyve.org/web-mdm-dashboard\n * @link       https://flyve-mdm.com\n * ------------------------------------------------------------------------------\n *//**\n * Component with page of 'validate account'\n * @class ValidateAccount\n * @extends PureComponent\n */var ValidateAccount=function(_PureComponent){_inherits(ValidateAccount,_PureComponent);/** @constructor */function ValidateAccount(props){var _this2=this;_classCallCheck(this,ValidateAccount);var _this=_possibleConstructorReturn(this,(ValidateAccount.__proto__||Object.getPrototypeOf(ValidateAccount)).call(this,props));_this.requestValidation=function(){var _ref=_asyncToGenerator(/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function _callee(account,validation){var session,response,isValidated,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,item;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _this.props.glpi.initSessionByUserToken({userToken:window.appConfig.demoToken});case 3:session=_context.sent;_this.props.glpi.sessionToken=session.session_token;_context.next=7;return _this.props.glpi.updateItem({itemtype:__WEBPACK_IMPORTED_MODULE_5_shared_itemtype__[\"a\" /* default */].PluginFlyvemdmdemoAccountvalidation,id:account,input:{_validate:validation}});case 7:response=_context.sent;isValidated=false;if(!Array.isArray(response)){_context.next=37;break;}_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context.prev=13;_iterator=response[Symbol.iterator]();case 15:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context.next=23;break;}item=_step.value;if(!item[account]){_context.next=20;break;}isValidated=true;return _context.abrupt('break',23);case 20:_iteratorNormalCompletion=true;_context.next=15;break;case 23:_context.next=29;break;case 25:_context.prev=25;_context.t0=_context['catch'](13);_didIteratorError=true;_iteratorError=_context.t0;case 29:_context.prev=29;_context.prev=30;if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return();}case 32:_context.prev=32;if(!_didIteratorError){_context.next=35;break;}throw _iteratorError;case 35:return _context.finish(32);case 36:return _context.finish(29);case 37:_this.setState({isLoading:false,isValidated:isValidated});_context.next=44;break;case 40:_context.prev=40;_context.t1=_context['catch'](0);_this.props.toast.setNotification(_this.props.handleMessage({type:'warning',message:_context.t1}));_this.setState({isLoading:false,isValidated:false});case 44:case'end':return _context.stop();}}},_callee,_this2,[[0,40],[13,25,29,37],[30,,32,36]]);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();_this.state={isValidated:false,isLoading:false};return _this;}/**\n   * Prepare the parameters of the validation request\n   * @function componentDidMount\n   */_createClass(ValidateAccount,[{key:'componentDidMount',value:function componentDidMount(){var path=this.props.location.pathname.replace('/validateAccount/','&validateAccount=');path=path.replace('/validation/','&validation=');var params=new URLSearchParams(path);var account=params.get('validateAccount');var validation=params.get('validation');if(account&&validation){this.setState({isLoading:true});this.requestValidation(account,validation);}}/**\n   * Validation request\n   * @async\n   * @function requestValidation\n   * @param {string} account\n   * @param {*} validation\n   */},{key:'render',/**\n   * Render component\n   * @function render\n   */value:function render(){var renderComponent=void 0;if(this.state.isLoading){renderComponent=__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement('div',{style:{height:'140px'}},__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_10__Loading__[\"a\" /* default */],{message:__WEBPACK_IMPORTED_MODULE_6_shared_i18n__[\"default\"].t('commons.loading')+'...'}));}else if(this.state.isValidated){renderComponent=__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_react___default.a.Fragment,null,__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement('h2',null,__WEBPACK_IMPORTED_MODULE_6_shared_i18n__[\"default\"].t('validate_account.title')),__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement('p',null,__WEBPACK_IMPORTED_MODULE_6_shared_i18n__[\"default\"].t('validate_account.is_validated'),__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement('br',null)),__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement('p',null,__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3_react_router_dom__[\"a\" /* Link */],{to:__WEBPACK_IMPORTED_MODULE_4_shared_publicURL__[\"a\" /* default */]+'/'},__WEBPACK_IMPORTED_MODULE_6_shared_i18n__[\"default\"].t('commons.sign_in'))));}else{renderComponent=__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_1_react___default.a.Fragment,null,__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement('h2',null,__WEBPACK_IMPORTED_MODULE_6_shared_i18n__[\"default\"].t('validate_account.title')),__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement('p',null,__WEBPACK_IMPORTED_MODULE_6_shared_i18n__[\"default\"].t('validate_account.message'),__WEBPACK_IMPORTED_MODULE_1_react___default.a.createElement('br',null)));}return renderComponent;}}]);return ValidateAccount;}(__WEBPACK_IMPORTED_MODULE_1_react__[\"PureComponent\"]);ValidateAccount.propTypes={toast:__WEBPACK_IMPORTED_MODULE_2_prop_types___default.a.shape({setNotification:__WEBPACK_IMPORTED_MODULE_2_prop_types___default.a.func}).isRequired,glpi:__WEBPACK_IMPORTED_MODULE_2_prop_types___default.a.object.isRequired,location:__WEBPACK_IMPORTED_MODULE_2_prop_types___default.a.object.isRequired,handleMessage:__WEBPACK_IMPORTED_MODULE_2_prop_types___default.a.func.isRequired};/* harmony default export */ __webpack_exports__[\"default\"] = (Object(__WEBPACK_IMPORTED_MODULE_7_hoc_withAuthenticationLayout__[\"a\" /* default */])(Object(__WEBPACK_IMPORTED_MODULE_9_hoc_withGLPI__[\"a\" /* default */])(Object(__WEBPACK_IMPORTED_MODULE_8_hoc_withHandleMessages__[\"a\" /* default */])(ValidateAccount)),{centerContent:true}));\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/5.e929bc99.chunk.js","/*\n *   Copyright © 2018 Teclib. All rights reserved.\n *\n *   This file is part of web-mdm-dashboard\n *\n * web-mdm-dashboard is a subproject of Flyve MDM. Flyve MDM is a mobile\n * device management software.\n *\n * Flyve MDM is free software: you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 3\n * of the License, or (at your option) any later version.\n *\n * Flyve MDM is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n * ------------------------------------------------------------------------------\n * @author     Gianfranco Manganiello (gmanganiello@teclib.com)\n * @author     Hector Rondon (hrondon@teclib.com)\n * @copyright  Copyright © 2018 Teclib. All rights reserved.\n * @license    GPLv3 https://www.gnu.org/licenses/gpl-3.0.html\n * @link       https://github.com/flyve-mdm/web-mdm-dashboard\n * @link       http://flyve.org/web-mdm-dashboard\n * @link       https://flyve-mdm.com\n * ------------------------------------------------------------------------------\n */\n\nimport React, {\n  PureComponent,\n} from 'react'\nimport PropTypes from 'prop-types'\nimport {\n  Link,\n} from 'react-router-dom'\nimport publicURL from 'shared/publicURL'\nimport itemtype from 'shared/itemtype'\nimport I18n from 'shared/i18n'\nimport withAuthenticationLayout from 'hoc/withAuthenticationLayout'\nimport withHandleMessages from 'hoc/withHandleMessages'\nimport withGLPI from 'hoc/withGLPI'\nimport Loading from '../Loading'\n\n/**\n * Component with page of 'validate account'\n * @class ValidateAccount\n * @extends PureComponent\n */\nclass ValidateAccount extends PureComponent {\n  /** @constructor */\n  constructor(props) {\n    super(props)\n    this.state = {\n      isValidated: false,\n      isLoading: false,\n    }\n  }\n\n  /**\n   * Prepare the parameters of the validation request\n   * @function componentDidMount\n   */\n  componentDidMount() {\n    let path = this.props.location.pathname.replace('/validateAccount/', '&validateAccount=')\n    path = path.replace('/validation/', '&validation=')\n    const params = new URLSearchParams(path)\n    const account = params.get('validateAccount')\n    const validation = params.get('validation')\n\n    if (account && validation) {\n      this.setState({\n        isLoading: true,\n      })\n      this.requestValidation(account, validation)\n    }\n  }\n\n  /**\n   * Validation request\n   * @async\n   * @function requestValidation\n   * @param {string} account\n   * @param {*} validation\n   */\n  requestValidation = async (account, validation) => {\n    try {\n      const session = await this.props.glpi.initSessionByUserToken({\n        userToken: window.appConfig.demoToken,\n      })\n      this.props.glpi.sessionToken = session.session_token\n      const response = await this.props.glpi.updateItem({\n        itemtype: itemtype.PluginFlyvemdmdemoAccountvalidation,\n        id: account,\n        input: {\n          _validate: validation,\n        },\n      })\n      let isValidated = false\n\n      if (Array.isArray(response)) {\n        for (const item of response) {\n          if (item[account]) {\n            isValidated = true\n            break\n          }\n        }\n      }\n\n      this.setState({\n        isLoading: false,\n        isValidated,\n      })\n    } catch (error) {\n      this.props.toast.setNotification(this.props.handleMessage({\n        type: 'warning',\n        message: error,\n      }))\n      this.setState({\n        isLoading: false,\n        isValidated: false,\n      })\n    }\n  }\n\n  /**\n   * Render component\n   * @function render\n   */\n  render() {\n    let renderComponent\n    if (this.state.isLoading) {\n      renderComponent = (\n        <div style={{ height: '140px' }}>\n          <Loading message={`${I18n.t('commons.loading')}...`} />\n        </div>\n      )\n    } else if (this.state.isValidated) {\n      renderComponent = (\n        <React.Fragment>\n          <h2>\n            {I18n.t('validate_account.title')}\n          </h2>\n          <p>\n            {I18n.t('validate_account.is_validated')}\n            <br />\n          </p>\n          <p>\n            <Link to={`${publicURL}/`}>\n              {I18n.t('commons.sign_in')}\n            </Link>\n          </p>\n        </React.Fragment>\n      )\n    } else {\n      renderComponent = (\n        <React.Fragment>\n          <h2>\n            {I18n.t('validate_account.title')}\n          </h2>\n          <p>\n            {I18n.t('validate_account.message')}\n            <br />\n          </p>\n        </React.Fragment>\n      )\n    }\n\n    return renderComponent\n  }\n}\n\nValidateAccount.propTypes = {\n  toast: PropTypes.shape({\n    setNotification: PropTypes.func,\n  }).isRequired,\n  glpi: PropTypes.object.isRequired,\n  location: PropTypes.object.isRequired,\n  handleMessage: PropTypes.func.isRequired,\n}\n\nexport default withAuthenticationLayout(withGLPI(withHandleMessages(ValidateAccount)), {\n  centerContent: true,\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/ValidateAccount/index.js"],"sourceRoot":""}